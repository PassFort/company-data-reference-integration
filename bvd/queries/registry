DEFINE F5 AS [Filter.Name=ContactsFilter;ContactsFilter.CurrentPreviousQueryString=1;ContactsFilter.HierarchicCodeQueryString=0|1|2|;ContactsFilter.SourcesToExcludeQueryString=99B|59B|69B|70B|0|278|278|;ContactsFilter.InformalSourcesToExclude=True;ContactsFilter.Previous=True;ContactsFilter.Currents=True;ContactsFilter.HierarchicCodeToExcludeQueryString=3|4|],
F2 AS [Filter.Name=ContactsFilter;ContactsFilter.InformalSourcesToExclude=True;ContactsFilter.SourcesToExcludeQueryString=99B|59B|69B|70B|0|278|278|;ContactsFilter.HierarchicCodeToExcludeQueryString=3|4|;ContactsFilter.HierarchicCodeQueryString=0|1|2|;ContactsFilter.HierarchicCodeToExcludeCountQueryString=3|4|;ContactsFilter.HierarchicCodeCountQueryString=0|1|2||],
F3 AS [Filter.Name=ContactsFilter;ContactsFilter.CurrentPreviousQueryString=0;ContactsFilter.HierarchicCodeQueryString=0|1|2|;ContactsFilter.SourcesToExcludeQueryString=99B|59B|69B|70B|0|278|278|;ContactsFilter.InformalSourcesToExclude=True;ContactsFilter.HierarchicCodeCountQueryString=0|1|2||;ContactsFilter.Currents=True;ContactsFilter.HierarchicCodeToExcludeQueryString=3|4|;ContactsFilter.HierarchicCodeToExcludeCountQueryString=3|4|],
F4 AS [Filter.Name=ContactsFilter;ContactsFilter.CurrentPreviousQueryString=1;ContactsFilter.HierarchicCodeQueryString=0|1|2|;ContactsFilter.SourcesToExcludeQueryString=99B|59B|69B|70B|0|278|278|;ContactsFilter.InformalSourcesToExclude=True;ContactsFilter.HierarchicCodeCountQueryString=0|1|2||;ContactsFilter.Previous=True;ContactsFilter.HierarchicCodeToExcludeQueryString=3|4|;ContactsFilter.HierarchicCodeToExcludeCountQueryString=3|4|],
P14 AS [Parameters.RepeatingMaxCount=1000;Parameters.RepeatingDimension=NrOfBvDContacts];
SELECT LINE GENERAL_INFO.NAME AS NAME,
LINE CONTACT_INFO.ADDR AS ADDR,
LINE CONTACT_INFO.ADDR2 AS ADDR2,
LINE CONTACT_INFO.ADDR3 AS ADDR3,
LINE CONTACT_INFO.ADDR4 AS ADDR4,
LINE CONTACT_INFO.POSTCODE AS POSTCODE,
LINE CONTACT_INFO.CITY AS CITY,
LINE CONTACT_INFO.COUNTRY AS COUNTRY,
LINE CONTACT_INFO.CTRYISO AS CTRYISO,
LINE CONTACT_INFO.LATITUDE AS LATITUDE,
LINE CONTACT_INFO.LONGITUDE AS LONGITUDE,
LINE CONTACT_INFO.REGION_IN_COUNTRY AS REGION_IN_COUNTRY,
LINE CONTACT_INFO.STATE_US AS STATE_US,
LINE CONTACT_INFO.COUNTY_US_CANADA AS COUNTY,
LINE CONTACT_INFO.ADDRTYPE AS ADDRTYPE,
LINE CONTACT_INFO.PHONE AS PHONE,
LINE CONTACT_INFO.WEBSITE AS WEBSITE,
LINE CONTACT_INFO.EMAIL AS EMAIL,
LINE IDENT_CODE.NATIONALID AS NATID_NUMBER,
LINE IDENT_CODE.NATIONALID_LABEL AS NATID_LABEL,
LINE IDENT_CODE.NATIONALID_TYPE AS NATID_TYPE,
LINE IDENT_CODE.TRADEREGISTERNR AS TRADEREGISTERNR,
LINE IDENT_CODE.VATNUMBER AS VATNUMBER,
LINE IDENT_CODE.EUROVAT AS EUROVAT,
LINE IDENT_CODE.BVDID AS BVDID,
LINE IDENT_CODE.BVD9 AS BVD9,
LINE IDENT_CODE.ISIN AS ISIN,
LINE IDENT_CODE.TICKER AS TICKER,
LINE IDENT_CODE.IRS AS IRS,
LINE IDENT_CODE.lei_LEI_Header AS LEI,
LINE GENERAL_INFO.PREVNAME AS PREVNAME,
LINE GENERAL_INFO.NAMECHDT AS NAMECHDT,
LINE GENERAL_INFO.AKANAME AS AKANAME,
LINE STATUS_ACC_INFO.HISTORIC_STATUS AS HISTORIC_STATUS_STR,
LINE STATUS_ACC_INFO.HISTORIC_INACTIVE AS HISTORIC_STATUSDATE,
LINE STATUS_ACC_INFO.HISTORIC_RECEPTION AS HISTORIC_STATUS_CHANGEDATE,
LINE STATUS_ACC_INFO.DATEINC AS DATEINC,
LINE STATUS_ACC_INFO.STATEINC1 AS STATEINC,
LINE ACTIVITIES.TRADDESCEN AS TRADDESCEN,
LINE ACTIVITIES.PRODUCTS_SERVICES AS PRODUCTS_SERVICES,
LINE ACTIVITIES.DESCHIST AS DESCHIST,
LINE ACTIVITIES.MAJOR_SECTOR AS MAJOR_SECTOR,
LINE ACTIVITIES.NATCLASS AS NATCLASS,
LINE ACTIVITIES.NATPCOD AS NATPCOD,
LINE ACTIVITIES.NATPDES AS NATPDES,
LINE ACTIVITIES.NATSCOD AS NATSCOD,
LINE ACTIVITIES.NATSDES AS NATSDES,
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_BvdId FILTER F5 USING P14 AS officer_bvd_ids,
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_IdDirector FILTER F5 USING P14 AS officer_ucis,
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_DIFFERENT_PERSONS_CNT FILTER F2 AS num_officers,
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_DIFFERENT_PERSONS_CNT1 FILTER F3 AS num_current_officers,
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_DIFFERENT_PERSONS_CNT2 FILTER F4 AS num_previous_officers,
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_Type FILTER F5 USING P14 AS officer_types, 
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_CurrentPrevious FILTER F5 USING P14 AS officer_current_previous,
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_OriginalJobTitle FILTER F5 USING P14 AS officer_roles, 
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_FullNameOriginalLanguagePreferred FILTER F5 USING P14 AS officer_full_names, 
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_FirstNameOriginalLanguagePreferred FILTER F5 USING P14 AS officer_first_names, 
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_MiddleNameOriginalLanguagePreferred FILTER F5 USING P14 AS officer_middle_names,
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_LastNameOriginalLanguagePreferred FILTER F5 USING P14 AS officer_last_names, 
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_BeginningNominationDate FILTER F5 USING P14 AS officer_appointed_dates, 
LINE DMC_CONTACTS.CPYCONTACTS_MEMBERSHIP_EndExpirationDate FILTER F5 USING P14 AS officer_resigned_dates, 
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_MultipleNationalitiesLabel FILTER F5 USING P14 AS officer_nationalities, 
LINE DMC_CONTACTS.CPYCONTACTS_HEADER_Birthdate FILTER F5 USING P14 AS officer_dobs, 
LINE STATUS_ACC_INFO.SLEGALF AS SLEGALF FROM RemoteAccess.A 
